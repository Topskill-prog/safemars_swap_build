"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2344],{20353:function(n,e,r){r.d(e,{Z:function(){return v}});var t=r(26042),o=r(69396),i=r(99534),c=r(85893),s=(r(67294),r(7297)),a=r(19521),u=r(57247),l=r(44147);function d(){var n=(0,s.Z)(["\n  0% {\n    background-position: 50% 0%;\n  }\n  50% {\n    background-position: 50% 100%;\n  }\n  100% {\n    background-position: 50% 0%;\n  }\n"]);return d=function(){return n},n}function h(){var n=(0,s.Z)(["\n      animation: "," 3s ease infinite;\n      background-size: 400% 400%;\n    "]);return h=function(){return n},n}function f(){var n=(0,s.Z)(["\n  background: ",";\n  border-radius: ",";\n  color: ",";\n  overflow: hidden;\n  position: relative;\n\n  ","\n\n  padding: 1px 1px 3px 1px;\n\n  ","\n"]);return f=function(){return n},n}function b(){var n=(0,s.Z)(["\n  width: 100%;\n  height: 100%;\n  overflow: ",";\n  background: ",";\n  border-radius: ",";\n"]);return b=function(){return n},n}var p=(0,a.F4)(d()),g=a.ZP.div.withConfig({componentId:"sc-eecfaa46-0"}).withConfig({componentId:"sc-62e22978-0"})(f(),(function(n){var e=n.isActive,r=n.isSuccess,t=n.isWarning,o=n.borderBackground,i=n.theme;return o||(t?i.colors.warning:r?i.colors.success:e?"linear-gradient(180deg, ".concat(i.colors.primaryBright,", ").concat(i.colors.secondary,")"):i.colors.cardBorder)}),(function(n){return n.theme.radii.card}),(function(n){var e=n.theme,r=n.isDisabled;return e.colors[r?"textDisabled":"text"]}),(function(n){return n.isActive&&(0,a.iv)(h(),p)}),u.Dh),k=(0,a.ZP)(l.Z).withConfig({componentId:"sc-eecfaa46-1"}).withConfig({componentId:"sc-62e22978-1"})(b(),(function(n){return n.hasCustomBorder?"initial":"inherit"}),(function(n){var e=n.theme,r=n.background;return null!==r&&void 0!==r?r:e.card.background}),(function(n){return n.theme.radii.card}));g.defaultProps={isActive:!1,isSuccess:!1,isWarning:!1,isDisabled:!1};var v=function(n){var e=n.ribbon,r=n.children,s=n.background,a=(0,i.Z)(n,["ribbon","children","background"]);return(0,c.jsx)(g,(0,o.Z)((0,t.Z)({},a),{children:(0,c.jsxs)(k,{background:s,hasCustomBorder:!!a.borderBackground,children:[e,r]})}))}},22344:function(n,e,r){r.r(e),r.d(e,{default:function(){return G}});var t,o=r(26042),i=r(828),c=r(7297),s=r(85893),a=r(97478),u=r(12410),l=r(19521),d=r(20353),h=r(75943),f=r(44147),b=r(88896),p=r(62077),g=r(95459),k=r(93888),v=r(47568),x=r(97582),m=r(67294),Z=r(28687),B=r(62621),N=r(6680),y=r(33533);function j(){var n=(0,c.Z)(['\n            query getNftMarketSubgraphHealth {\n              indexingStatusForCurrentVersion(subgraphName: "','") {\n                synced\n                health\n                chains {\n                  chainHeadBlock {\n                    number\n                  }\n                  latestBlock {\n                    number\n                  }\n                }\n              }\n            }\n          ']);return j=function(){return n},n}!function(n){n[n.OK=0]="OK",n[n.WARNING=1]="WARNING",n[n.NOT_OK=2]="NOT_OK",n[n.UNKNOWN=3]="UNKNOWN"}(t||(t={}));var w=function(n){var e=(0,m.useState)({status:t.UNKNOWN,currentBlock:0,chainHeadBlock:0,latestBlock:0,blockDifference:0}),r=e[0],o=e[1];return(0,y.X)((function(e){var r=function(){var r=(0,v.Z)((function(){var r,c,s,a,u,l,d,h,f;return(0,x.__generator)(this,(function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,Promise.all([(0,Z.request)(N.AM,(0,Z.gql)(j(),n)),e?Promise.resolve(e):B.v.getBlockNumber()])];case 1:return r=i.Z.apply(void 0,[b.sent(),2]),c=r[0].indexingStatusForCurrentVersion,s=r[1],a="healthy"===c.health,u=parseInt(c.chains[0].chainHeadBlock.number),l=parseInt(c.chains[0].latestBlock.number),d=s-l,h=s-u,o(!a||d>200||h>200?{status:t.NOT_OK,currentBlock:s,chainHeadBlock:u,latestBlock:l,blockDifference:d}:d>50||h>50?{status:t.WARNING,currentBlock:s,chainHeadBlock:u,latestBlock:l,blockDifference:d}:{status:t.OK,currentBlock:s,chainHeadBlock:u,latestBlock:l,blockDifference:d}),[3,3];case 2:return f=b.sent(),console.error("Failed to perform health check for ".concat(n," subgraph"),f),[3,3];case 3:return[2]}}))}));return function(){return r.apply(this,arguments)}}();r()}),[n]),r};function C(){var n=(0,c.Z)(["\n  border-radius: 8px;\n  > div {\n    border-radius: 8px;\n  }\n  user-select: none;\n"]);return C=function(){return n},n}function S(){var n=(0,c.Z)(["\n  gap: 7px;\n"]);return S=function(){return n},n}function I(){var n=(0,c.Z)(["\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: ",";\n"]);return I=function(){return n},n}var O,D,K,_=(0,l.ZP)(d.Z).withConfig({componentId:"sc-ede3f102-0"})(C()),P=(0,l.ZP)(h.Z).withConfig({componentId:"sc-ede3f102-1"})(S()),W=(0,l.ZP)(f.Z).withConfig({componentId:"sc-ede3f102-2"})(I(),(function(n){var e=n.$color;return n.theme.colors[e]})),A=function(n,e){return{delayed:{label:n("Delayed"),color:"failure",description:null!==(O=null===e||void 0===e?void 0:e.delayed)&&void 0!==O?O:n("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},slow:{label:n("Slight delay"),color:"warning",description:null!==(D=null===e||void 0===e?void 0:e.slow)&&void 0!==D?D:n("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},healthy:{label:n("Fast"),color:"success",description:null!==(K=null===e||void 0===e?void 0:e.healthy)&&void 0!==K?K:n("No issues with the subgraph.")}}},F=function(n){var e=n.color,r=n.label,t=n.description,o=n.currentBlock,i=n.secondRemainingBlockSync,c=n.blockNumberFromSubgraph,a=(0,u.$G)().t;return(0,s.jsxs)(f.Z,{children:[(0,s.jsxs)(P,{pb:"10px",children:[(0,s.jsx)(W,{$color:e}),(0,s.jsx)(p.Z,{children:r})]}),(0,s.jsx)(p.Z,{pb:"24px",children:t}),(0,s.jsxs)(p.Z,{children:[(0,s.jsxs)("strong",{children:[a("Chain Head Block"),":"]})," ",o]}),(0,s.jsxs)(p.Z,{children:[(0,s.jsxs)("strong",{children:[a("Latest Subgraph Block"),":"]})," ",c]}),(0,s.jsxs)(p.Z,{children:[(0,s.jsxs)("strong",{children:[a("Delay"),":"]})," ",o-c," (",i,"s)"]})]})},G=function(n){var e,r=n.subgraphName,c=n.inline,l=n.customDescriptions,d=n.obeyGlobalSetting,h=void 0===d||d,v=(0,u.$G)().t,x=w(r),m=x.status,Z=x.currentBlock,B=x.blockDifference,N=x.latestBlock,y=(0,i.Z)((0,k.YF)(),1)[0],j=m===t.WARNING||m===t.NOT_OK,C=h&&y||j,S=A(v,l),I=B*a.hJ,O=S[(e=m)===t.NOT_OK?"delayed":e===t.WARNING?"slow":"healthy"],D=(0,b.Z)((0,s.jsx)(F,(0,o.Z)({currentBlock:Z,secondRemainingBlockSync:I,blockNumberFromSubgraph:N},O)),{placement:"top"}),K=D.targetRef,G=D.tooltipVisible,H=D.tooltip;return N&&Z&&C?c?(0,s.jsxs)(P,{alignItems:"center",justifyContent:"flex-end",ref:K,children:[(0,s.jsx)(W,{$color:O.color}),(0,s.jsx)(p.Z,{children:O.label}),(0,s.jsx)(g.Z,{}),G&&H]}):(0,s.jsxs)(f.Z,{position:"fixed",bottom:"calc(55px + env(safe-area-inset-bottom))",right:"5%",ref:K,"data-test":"subgraph-health-indicator",children:[G&&H,(0,s.jsx)(_,{children:(0,s.jsxs)(P,{alignItems:"center",p:"10px",children:[(0,s.jsx)(W,{$color:O.color}),(0,s.jsx)(p.Z,{children:O.label}),(0,s.jsx)(g.Z,{})]})})]}):null}}}]);
//# sourceMappingURL=2344.46298e25ef61157b.js.map